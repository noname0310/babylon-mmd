---
sidebar_position: 4
sidebar_label: マーテリアルモーフィングの有効化
---

# マーテリアルモーフィングの有効化

MMDモデルは**マーテリアルモーフィング**をサポートしており、これはアニメーションを通じてマーテリアルパラメータを制御できる機能です。

この機能は通常、アニメーションを通じてMMDモデルの一部をオンまたはオフにするために使用されます。

この機能は、babylon-mmdでは**デフォルトで無効**になっていますが、`MmdModel`オブジェクトを作成する際にマーテリアルプロキシインプリメンテーションを渡すことで有効化できます。

```typescript
const mmdModel = mmdRuntime.createMmdModel(mmdMesh, {
    materialProxyConstructor: MmdStandardMaterialProxy
});
```

:::info
「babylon-mmd」パッケージルートをインポートした場合、サイドエフェクトを通じてマーテリアルモーフィングが**自動的に有効**になります。

これは使いやすさのための便利機能ですが、上記のようにマーテリアルプロキシを渡して**明示的に有効化する**ことが**推奨**されます。
:::

## マーテリアルプロキシ

マーテリアルパラメータを操作する際、MMDランタイムは**マーテリアルに直接アクセスせず**、マーテリアルプロキシを通してアクセスします。

このアプローチにより、**任意のタイプのマーテリアル**を使用するMMDモデルでマーテリアルモーフィングのサポートが可能になります。

babylon-mmdは**2つのマーテリアルプロキシ**を提供しており、`IMmdMaterialProxy`インターフェースを実装するクラスを作成することで独自のものを実装することもできます。

- `MmdStandardMaterialProxy`：`MmdStandardMaterial`を使用するMMDモデル用のマーテリアルプロキシ
- `StandardMaterialProxy`：`StandardMaterial`を使用するMMDモデル用のマーテリアルプロキシ

:::warning
MMDモデルで使用されているマーテリアルと**互換性のない**マーテリアルプロキシを渡すと、ランタイムエラーが発生する可能性があります。
:::
